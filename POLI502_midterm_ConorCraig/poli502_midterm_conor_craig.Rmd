---
output:
  pdf_document: default
  html_document: default
---
\begin{center}

Rcode for POLI502 MidtermPOLI502

Methods of Political Analysis 

Student ID: K23040690

2023-10-16
\end{center}

Question 1
Loading Packages and Data

```{r, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(readr)
world.data <- read.csv("~/School/Fall 2023/Poli 502/world.csv")
```

Question 2
Frequency Table

```{r}
freq_table_oced <- table (world.data$oecd)
ft.oecd <- data.frame(freq_table_oced)
# renames variable
ft.oecd <- ft.oecd %>% rename("OECD Member?" = "Var1")
# adds percentage to the table
ft.oecd $ Percentage <- round(prop.table(ft.oecd $ Freq) * 100, digits = 2)
ft.oecd
```
Question 3

  3A. 30 countries within the data set are OECD members
  3B. 161 countries within the data set are not OECD members
  3C. 15.71% of countries within the data set are OECD members, and
  3D. 84.29% of countries within the data set are not OECD members. 

Question 4
Creating a bar chart of OECD country membership

```{r}
ggplot(world.data, aes (x = oecd)) + geom_bar() + 
  labs (x = "OECD membership", y = "Number of Countries") +
  theme_minimal()
```

Question 5
three countries that are OECD members, and three countries that aren't democracies

```{r}
# filters out for OECD members and puts them in a vector
oecd_members <- world.data %>% filter (oecd == "OECD Member state")
# shows the top 3 OECD members
head(oecd_members, 3)
# filters out the non-democracies
non_democracies <- world.data %>% filter (democ_regime == "No")
# shows the top 3 non-democracies
head(non_democracies, 3)
```

Question 6
statistics on GDP

```{r}
# summary provides the range, median, mean, and 1st and 3rd quartile
summary(world.data$gdp_10_thou)
# creating a vector of gdp with no NAs to determine the standard deviation
gdp_no_na <- na.omit(world.data$gdp_10_thou)
sd(gdp_no_na)
```

Question 7
Since the median is lower than the mean, the distribution will have a positive 
skew. That is, the majority of case will occur on the left side of the graph, 
but there will be a longer tail on the right side of the graph that pulls the 
mean up. 

Question 8
Graphing GDP

```{r}
gdp_data_frame <- data.frame (gdp_no_na)
ggplot (gdp_data_frame, aes (x = gdp_no_na)) + geom_histogram() +
  labs (x = "Per capita GDP (in 10,000 US dollars)", y = "Number of Countries") +
  theme_minimal()
```

Question 9
Listing 2 countries with gdp per capita over 40k

```{r}
# filter out countries to just have the countries that are at 40k or higher
gdp_40k <- world.data %>% filter (gdp_10_thou >= 4)
head(gdp_40k)
```
Question 10
Calculating Standard Error
Standard Error = standard deviaion / sqrt of n

```{r}
n <- length(gdp_no_na)
s <- sd(gdp_no_na)
s/sqrt(n)
```
The standard error is 0.0709

Question 11
Calculating the 95% confidence interval for GDP capita

```{r}
# placing the mean in a variable for easy use
mean_gdp_capita <- mean(gdp_no_na)
mean_gdp_capita
# placing the standard error in a variable for easy use
standard_error <- s/sqrt(n)
standard_error *2
# Upper bound of the confidence interval
mean_gdp_capita + (standard_error *2)
# Lower bound of the confidence interval
mean_gdp_capita - (standard_error *2)
```

the confidence interval is 0.6 plus or minus 0.14 yielding a range from 0.46 to
0.74. It should be remembered that this variable is in units of 10,000, meaning
that the confidence interval is $4,600 - $7,400

Question 12
Graphing Gdp per capita by whether democracy or not

```{r}
# separating democracies and non-democracies
gdp_cap_demo <- world.data %>% filter (democ_regime == "Yes") %>% select (gdp_10_thou)
dp_cap_no_demo <-world.data %>% filter (democ_regime == "No") %>% select (gdp_10_thou)

# putting these into a data frame to use ggplot
demo_gdp_frame <- data.frame (gdp_cap_demo)
no_demo_gdp_frame <- data.frame (dp_cap_no_demo)

# creating ggplots of each
demo_plot <- ggplot(demo_gdp_frame, aes(x = gdp_10_thou)) + geom_histogram() +
  labs (x = "Per capita GDP (in 10,000 US dollars)", y = "Number of Democratic Countries") +
  theme_minimal()

non_demo_plot <- ggplot(no_demo_gdp_frame, aes(x = gdp_10_thou)) + geom_histogram() +
  labs (x = "Per capita GDP (in 10,000 US dollars", y = "Number of Non-Democratic Countries") + theme_minimal()

# putting the plots side by side
grid.arrange(demo_plot,non_demo_plot,ncol=2)
```

Question 13
Regraphing the graphs above

```{r}
# creating new isolate data frame
dem_data <- world.data[c("democ_regime", "gdp_10_thou")]

# removing NAs from democratic data
dem.gdp <- na.omit(dem_data)
data_frame_dem_gdp <- data.frame(dem.gdp)

# Changing yes and no to be democracy and autocracy
dem.gdp$democ_regime <- ifelse (dem.gdp$democ_regime == "Yes", "Democracy", "Autocracy")

# Creating the dual plots
g <- ggplot (dem.gdp, aes (x = gdp_10_thou))
g <- g + geom_histogram()
g <- g + xlab("Per capita GDP (in 10,000 US dollars")
g <- g + ylab ("Number of Countries")
g <- g + theme_minimal()
g <- g + facet_wrap (~ democ_regime)
g
```

Question 14
Calculating the confidence interval for democracies

```{r}
# Calculating the mean and standard deviation
mean_gdp_capita_demo <- mean(subset (dem.gdp, democ_regime == "Democracy")$gdp_10_thou)
sd_gdp_capita_demo <- sd(subset(dem.gdp, democ_regime == "Democracy")$gdp_10_thou)

# Finding the n to determine the standard error
n_demo <- length (subset(dem.gdp, democ_regime == "Democracy")$gdp_10_thou)

# Calculating the standard error
standard_error_demo <- sd_gdp_capita_demo / sqrt(n_demo)

# 95% confidence interval
#Upper Bound
mean_gdp_capita_demo + (standard_error_demo *2)
# Lower Bound
mean_gdp_capita_demo - (standard_error_demo *2)
```
Democracies have a mean per capita GDP of 8,014 plus or minus $2,071, leaving
a 95% confidence interval of $5,943 to $10,084 (numbers are rounded)

Question 15
Calculating the confidence interval for autocracies
```{r}
# Calculating the mean and standard deviation
mean_gdp_capita_auto <- mean(subset (dem.gdp, democ_regime == "Autocracy")$gdp_10_thou)
sd_gdp_capita_auto <- sd(subset(dem.gdp, democ_regime == "Autocracy")$gdp_10_thou)

# Finding the n to determine the standard error
n_auto <- length (subset(dem.gdp, democ_regime == "Autocracy")$gdp_10_thou)

# Calculating the standard error
standard_error_auto <- sd_gdp_capita_auto / sqrt(n_auto)
standard_error_auto *2

# 95% confidence interval
#Upper Bound
mean_gdp_capita_auto + (standard_error_auto *2)
# Lower Bound
mean_gdp_capita_auto - (standard_error_auto *2)
```
Autocracies have a mean gdp/capita of $2,819, plus or mins $1,295 to construct
a 95% confidence interval. This leaves a range of $4,114 to $1,523

Since there is no cross over between the two confidence intervals, we can be
very confidence that democracies do have higher GDPs/capita on average than
autocracies. 

Question 16
Determining the probability of rain after clouds. 

```{r}
# first determine the probability of just clouds. 
# c = clouds
# r = rain
# Using the law of total probability to find the probability of clouds are any
  # day
# p(c) = p(c|r) *p(r) + p(c|~r)*p(~r)
# p(c|r) = 95%
# p(r) = 30%
# p(c|~r) = 25%
# p(r) = 100 - 30 = 70%

prob_clouds <- (.95*.3) + (.25*.7)
prob_clouds
# prob cloud = 46%

# Using Bayes' rule to determine p(r|c)
# p(r|c) = (p(c|r)*p(r)) / p(c)

prob_rain_given_clouds <- (.95*.3)/.46
prob_rain_given_clouds
```
The probability of seeing rain after seeing clouds is fairly high at 61.96%

Question 17
Multiple Bayesian Questions

17a. 
```{r}
# using the formulas given within the question, the mean is detemined by
  #a/(a+b) and the standard deviation by ab/ (a+b+1)(a+b)^2
# a and b are both equal to 1.5

prior_mean <- 1.5/(1.5+1.5)
prior_standard_d <- (1.5*1.5)/(((1.5+1.5+1)*(1.5+1.5))^2)
prior_mean
prior_standard_d
```
The prior mean is 0.5 and the prior standard devitation is 0.0156

17b.

```{r}
# Again, using the formula given:
pbeta(.6, 1.5, 1.5)
```
The probability of the prior theta being greater than 60% is 62.6%

17c. 
```{r}
# Using the idea that theta is equal to 60%, we use the formula given. 
likelihood <- (.6^37)*((1-.6)^13)
likelihood
```
The likelihood of the data given the prior appears to be very small (though I'm
not sure what is a typical range for likelihoods) at 4.15e-14

17d.

```{r}
# the prior distribution
prior_dist <- (.6^.5)*(.4^.5)
posterior_dist <- likelihood * prior_dist
posterior_dist
```
Again, without knowing a typical value to judge by, the posterior distribution
is 2.034613e-14

17e. 
```{r}
theta<-seq(0.01,0.99,0.01)
a <- 1.5
b <- 1.5
c <- 37 - 1.5
d <- 13 - 1.5
 prior<-dbeta(theta,a,b)
 posterior<-dbeta(theta,c,d)
 plot(theta,posterior,xlab=expression(theta),ylab="Density",type="l")+
 lines(theta, prior,lty=2)

```
17f. 

The graph above is showing both the prior and posterior distributions. The
prior is the dotted line, the posterior is the solid line. The posterior shows
that the distribution we have thus far has more approval of the professor than
initially anticipated


















